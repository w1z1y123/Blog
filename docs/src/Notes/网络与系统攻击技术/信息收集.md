---
desc: "信息收集"
tags: "网络与系统攻击技术"
outline: deep
---

# 信息收集

## 网络信息搜集技术概括

### 网络攻击信息收集
**入手点**

目标的名称和域名

**途径**

攻击目标的具体消息->目标网络中的活跃的主机->细致信息探查

1. 具体消息：
    - 网络世界中通信地址——Ip地址范围、详细的注册信息、DNS服务器位置、外部网络拓扑结构等
    - 尝试映射目标在真实世界中的地理位置
2. 网络中的活跃的主机：
    - 目标网络中活跃的主机、操作系统的类型、开放的端口和端口后面所运行的网络服务类型，以及是否存在已经披露的安全漏洞
3. 细致的信息
    - 用户账号、共享资源、网络服务类型与版本号

**安全防护机制**

目标网络的内部拓扑结构、目标系统与外部网络的连接方式与链路路径、防火墙的端口过滤与访问控制配置情况、使用的身份认证与访问控制机制、使用的加密系统

### 网络防御信息收集

- 追查入侵者的身份、网络位置、所攻击的目标、采用的攻击方法
- 一般被归入取证与追踪技术范围


## 网络踩点技术

- 有计划、有步骤的信息情报搜集
- 了解攻击目标的网络环境和信息安全状况
- 得到攻击目标剖析图

**踩点目的**

通过对完整剖析图的细致分析，攻击者将从中寻找出攻击目标可能存在的薄弱环节，为进一步的攻击行动提供指引

**目标组织**
- 具体使用的域名
- 网络地址范围
- 因特网上可以直接访问的IP地址与网络服务
- 网络拓扑结构
- 电话号码段
- 电子邮件列表
- 信息安全状况

**目标个人**
- 身份信息、联系方式、职业经历，甚至一些个人隐私信息

### 网络踩点技术手段
- DNS与IP查询
- Web信息搜索与挖掘
- 网络拓扑侦查


**DNS与IP查询**


注册人(Registrant) ->注册商(Registrar)->官方注册局(Registry)

DNS 服务：权威 DNS 服务器、递归缓存 DNS 服务器

**Web信息搜索与挖掘**

对目标组织和个人的大量公开或意外泄露的Web信息进行挖掘

**网络拓扑侦查**

Unix 的 traceroute
Windows 的 tracert


## 网络扫描技术

**目标**

直接使用各种扫描工具，在网段内找到存活主机，确定其操作系统与搭载服务，从而进行更具有针对性的安全攻击测试

|网络扫描类型|网络扫描目的|对比|
|-------|-------|--------|
|主机扫描|找出网段内活跃主机|确定目标：找出大楼中有人入住的房间|
|端口扫描|找出主机上所开放的网络服务|寻找门窗：找到可进入房间门窗的位置|
|操作系统/网络服务辨识|识别主机上安装的操作系统的类型与开放网络服务类型，选择不同渗透攻击代码及配置|识别房间、门窗的材质类型；针对不同的结构采用不同的破解工具|
|漏洞扫描|找出主机/网络服务上存在的安全漏洞，作为破解通道|缝隙/漏洞搜索：进一步发现门窗可以撬开的缝隙|

### 主机扫描(ping 扫描)

**目标**

检测目标主机是否活跃

**扫描方式**
- 传统ICMP Ping扫描
- ACK Ping扫描
- SYN Ping扫描
- UDP ping扫描

**防范措施**
- 单一主机ping扫描很常见，危害性也并不大，更关注ping扫射
- 网络入侵检测系统Snort;主机扫描监测工具Scanlogd
- 防御：仔细考虑对ICMP通信进行过滤

### 端口扫描技术

**目的**
- 防御者：更加了解所管理的网络状况，找到没有必要开放的端口进行关闭
- 攻击者：找出可供进一步攻击的网络服务，同时结合操作系统探测技术可以确定目标主机所安装的操作系统版本

**扫描方式**
- TCP连接扫描(建立三次握手，优点：无需特权用户权限就可以发起 缺点：目标主机上记录大量连接和错误信息，易于检测)
- SYN扫描(攻击者SYN, 目标主机SYN|ACK, 攻击者立即反馈RST包关闭连接  优点：目标主机不会记录未建立连接，较为隐蔽 缺点：需要根用户权限构建定制SYN 包)
- 隐藏端口扫描方式：(构造特殊的TCP标志位，躲避检测；开放端口：标准TCP协议规范，接受这些伪造TCP包，丢弃，无任何反馈 关闭端口：反馈RST包 <font color="red">windows/Cisco 不适用</font>)
- UDP 端口扫描

### 系统类型探测

**目的**

探查活跃主机的系统及开放网络服务的类型

**实现技术**
- 操作系统主动探测技术(各种不同操作系统类型和版本实现机制上的差异:1.协议栈实现差异－协议栈指纹鉴别 2.开放端口的差异－端口扫描 3.应用服务的差异－旗标攫取)
- 操作系统被动探测技术
- 网络服务主动探测技术(主要依靠网络服务在实现应用层协议时所包含的特殊指纹信息)
- 网络服务被动辨别技术

### 漏洞扫描

硬件、软件或策略上存在的安全缺陷，从而使得攻击者能够在未授权的情况下访问、控制系统



## 网络查点

在网络踩点、扫描之后一项网络情报信息搜集技术，针对识别出的服务进行更加充分更具针对性的探查，来寻找真正可以攻击的入口

- 相对于网络踩点，攻击者的入侵程度更加深入
- 相对于网络烧面，攻击者更加具有目标性与信息搜集的目标性

**查点技术**
- 网络服务旗标抓取技术(连接到远程应用程序并现察其输出)
  - 旗标（banner）是指在第一次连接时，目标软件给出的软件名称、版本号等信息
- 通用网络服务(Web服务、FTP文件传输服务、POP3及SMTP电子邮件收发服务)
- Windows平台网络服务(NetBIOS网络基本输入输出系统服务、SMB文件与打印共享服务)

**防范**
- 将不必要的网络服务全部关闭
- 加强网络服务安全配置
- 放弃使用不安全的网络协议


### ICMP 协议

Internet Control Message Portocol 互联网控制消息协议 ，对于一个新搭建好的网络，往往需要先进行一个简单的测试，验证网络是否畅通；

**功能**
- 确认IP包是否成功的到达目标地址
- 通知在发送的过程中IP包被丢弃的原因

## 网络嗅探与协议分析

利用计机网络接口截获目的地为其他计算机的数据报文，监听网络流中所包含的用户账户密码或私密信息等


**实现**
- 嗅探的硬件
- 嗅探的软件

### 网络嗅探的原理与实现

**以太网工作原理与模式**

工作原理：以太网采用CSMA/CD 技术，由于使用了广播机制，所以，所有在同一媒介信道上连接的工作站都可以看到网络上传递的数据

工作模式：
   - 混杂模式：不管数据帧中的目的地址是否与自己的地址匹配，都接收下来
   - 非混杂模式：只接收目的地址相匹配的数据帧，以及广播数据

**交换式网络**

通过Hub(集线器)连接，能够嗅探整个Hub上的全部流量

**交换式网络**

通过Switch 连接，发送包只发送到特定端口


**类Unix平台技术实现**

- BPF(Berkeley Packet Filter)：系统链路层的一种原始接口，提供原始链路层封包的收发功能
- Libpcap:用户态下的抓包工具，独立于不同操作系统


**Windows平台技术实现**

- NPF：内核态虚拟设备驱动程序，功能是过滤数据包
- Winpcap:用户态

### 检测技术

网卡和操作系统对于是否处于混杂模式会有一些不同的行为，利用这些特征可以判断一个机器是否运行在混杂模式下

**根据操作系统特征**
- Linux内核特性：构造无效以太地址而IP地址有效的ICMP ECHO请求，看机器是否返回应答包(混杂模式)，或忽略(非混杂模式)
- Windows :混杂模式下，检查一个包是否为以太网包，只看MAC地址前八位是否为0xff

**根据网络与主机的性能**
- 根据响应时间

### 防范措施

- 采用安全的网络拓扑结构
- 共享式以太网->交换式以太网拓扑
- 静态ARP或者MAC 代替动态机制
- 避免使用明文传输口令，使用加密协议


## 网络协议分析技术

对网络上传输的二进制格式数据包进行解析，恢复出各层网络协议信息以及传输内容的技术方法

**一般步骤**
1. 预处理：判断是否有误
2. 拆包：将单前包的指针赋给相对应的程序指针
3. 解析：交给特定的例程进行解析