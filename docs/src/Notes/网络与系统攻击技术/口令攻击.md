---
desc: "口令攻击"
tags: "网络与系统攻击技术"
outline: deep
---

# 口令攻击


## 身份认证与口令

### 身份认证

用户向计算机系统以一种安全的方式提交自己的身份证明，然后由系统确定用户的身份是否属实，最终拒绝用户或者赋予用户一定的权限

**身份认证的一些方式**
- 用户名和密码验证
- 磁卡或者智能卡认证
- 基于人的生理特征认证
- 基于地理位置的认证
- 其它特殊的认证方式

### 口令攻击分类

- 本地口令猜解
- 远程口令猜测
- 应用程序口令猜解
- 操作系统口令猜解
- 主动攻击
- 被动攻击

**主动口令攻击**

- 字典攻击
  - 通常是由很多条可能的口令字而组成的一个纯文本文件

- 强力攻击
  - 尝试使用所有的字符组合方式，逐一模拟口令验证过程
- 组合攻击


**被动截获**

- 欺骗攻击
  - 钓鱼攻击
- 嗅探攻击
- 键盘记录


## Windows 下的口令攻击

### 验证协议

- LAN Manager协议
  - 口令->hash值
- NTLM
- NTLMv2
- Kerberos认证

**LAN Manager**
1. 用户输入的密码被转化成大写
2. 这个大写的密码被分割成两个等长的部分，每个部分包含7个字符，如果密码的长度小于14个字符，剩余直接进行null填充
3. 每个7字符的部分被用作一个56位的DES密钥，这两个密钥分别对一个固定的字符串"KGS!@#$%"进行加密
4. 这两次加密的结果被拼接在一起，形成一个16字节（128位）的哈希值，这就是LM哈希

> 所有的密码都转化成大写，大大降低了密码的复杂性；密码被分割成两个部分，单独加密意味着可以分别破解这两个部分；


**NTLM**

1. 把口令变成Unicode编程
2. 使用MD4散列算法
3. 保存得到128位散列值


### 口令存储

SAM 数据库：Windows系统使用安全账号管理器的机制来管理用户账户，保存缓冲区的口令hash串

### 常用口令攻击方法

- 本地获取
- 远程猜解
- 嗅探

**Rainbow tables**

指定字符的各种组合以及这些组合经过MD5或LM或NTLM等加密手段加密后的对照表